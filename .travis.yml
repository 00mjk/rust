language: rust
sudo: false

cache:
  cargo: true
  directories:
    - $HOME/.cache/bazel

rust: nightly

before_install:
  - openssl aes-256-cbc -K $encrypted_a0be6b989bf3_key -iv $encrypted_a0be6b989bf3_iv -in travis-ci/travis_rsa.enc -out ~/.ssh/id_rsa -d
  - chmod 600 ~/.ssh/id_rsa

install:
  - export CC="gcc-4.9" CXX="g++-4.9"
  - source travis-ci/install.sh

script:
  - cargo test -vv -j 1 --features tensorflow_unstable
  - (cd tensorflow-sys && cargo test -vv -j 1)

after_success:
  - travis-ci/documentation.sh

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test

    packages:
      - g++-4.9
      - gcc-4.9
      - oracle-java8-installer
      - python-numpy
      - swig

notifications:
  email: false
